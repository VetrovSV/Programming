# API сервер

**Цель работы** — научиться создавать простой API-сервер, который обрабатывает запросы к обученной модели из пакета sklearn.

См. также задание по созданию [простого веб-приложения с Gradio](gradio.md).

#### Обязательно

Создайте API сервер используя фреимворк FastAPI. Используйте в качестве основы задание [Виртуальное окружение](tasks_programming.md#виртуальное-окружение).

В качестве модели МО используйте заранее обученную модель линейной регрессии [из одноимённого задания](https://github.com/ivtipm/ML/blob/main/plans/AI_intro_2025/2025_ML_intro.md#%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D0%B0%D1%8F-%D1%80%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F)

1. Загрузите модель МО. Используйте заранее обученную и сохранённую модель (формат .joblib/.pkl). Рекомендуется в названии файла оставлять версию sklearn и pickle. 
1. *Бонус: протестируйте модель. Используйте заранее созданные тесты.*
1. Создайте эндпоинты (endpoints):
    * `GET /ping` → `{"status":"ok"}`
    * `/prediction` — принимает значение независимых признаков, возвращает предсказаний целевой признак. Принимайте POST (с JSON в теле) или GET запрос. 
    * `GET /model_info` — возвращает коэффициенты модели линейной регрессии, R2. R2 должен быть заранее вычислен на тестовой выборке (лучше — через кросс-валидацию). 
1. Создайте README с описанием: 
    - структуры приложения: модули, папки, служебные файлы
    - как настроить приложение: создать venv, pip install -r requirements.txt, ... 
    - как запустить приложение
    - как проверить: базовую работоспособность приложения, получить предсказание
    - как посмотреть документацию к API
* Документируйте код, пишите поясняющие комментарии.
1. Создайте простое консольное клиентское приложение. Оно должно выполнять несколько запросов к серверу и выводить результаты на экран.
1. *Бонус: используйте версионирование для API. Например `/api/v1/...`*
1. *Бонус: сохраняйте параметры приложения в .env файлах. Например название файла модели, R2, коэффициенты модели, порт и IP сервера*

**Рекомендуемая структура проекта**
- app/
    - server.py
    - ml_tools.py 
- models/
    - модель
    - файл с параметрами (коэффициентами) модели и R2, например model_info.json
- .env файлы
- файлы requirements 
- readme

**Справка**
- OpenAPI, FastAPI:
    - [API/readme.md - которко об FastAPI](../../../API/readme.md)
    - [примеры: API/examples](API/examples)
    - пример работы с пакетом requests для http-запросов
- Работа с `.env` файлами: https://github.com/VetrovSV/Programming/blob/master/config_files.md
